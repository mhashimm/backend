!function(n){function t(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return n[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var e={};return t.m=n,t.c=e,t.p="/assets/",t(0)}([function(n,t,e){(function(n){"use strict";function t(n){return n&&n.__esModule?n:{"default":n}}function r(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}var i,o=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},a=e(2),u=t(a),c=e(3),s=t(c),f=e(5),l=new Map,h=void 0,d=!1,p=new Array;n.onconnect=function(n){var t=n.ports[0];t.onmessage=function(n){if(n.data instanceof Object)if(n.data.hasOwnProperty("username"))h=Object.assign.apply(Object,[{},h].concat([n.data]));else if(n.data.hasOwnProperty("token"))h=Object.assign({},h,n.data);else if(n.data.hasOwnProperty("isOnline"))d=n.data.isOnline,n.data.hasOwnProperty("type")&&(p=[t].concat(r(p)));else if(n.data.hasOwnProperty("entity")&&n.data.hasOwnProperty("table")&&n.data.hasOwnProperty("path")&&n.data.hasOwnProperty("action")){if(void 0!==h){var e=(0,s["default"])(h);e.open(),y(o({},n.data),n.data.entity,e)}}else n.data.hasOwnProperty("table")&&n.data.hasOwnProperty("path")&&n.data.hasOwnProperty("action")&&l.set(n.data.table,n.data);clearInterval(i),v()&&(i=setInterval(function(){v()?!function(){var n=(0,s["default"])(h);n.open(),l.forEach(function(t,e,r){n[e].where("status").equals("PENDING_IDLE").each(function(e){y(t,e,n)})})}():clearInterval(i)},u["default"].entityUpdateInterval))}};var v=function(){return void 0!==h&&void 0!==h.token&&d&&l.size>0},y=function(n,t,e){var r=n.path,i=n.action,o=n.table,a=Object.assign({},t);delete a.status;var c=Object.freeze(a);p.forEach(function(n){return n.postMessage({action:i,entity:c,status:f.PENDING_ACTIVE})});var s=e[o],l=e[o+"Orig"];s.get(c.id).then(function(n){void 0===n.status&&l.put(n)}).then(function(){return s.put(Object.assign({},c,{status:f.PENDING_IDLE}))});var d="undefined"!=typeof c.isNew&&c.isNew;fetch(u["default"].apiUrl+(d?r.post:r.put),{method:d?"POST":"PUT",body:JSON.stringify(c),mode:u["default"].cors,headers:new Headers({Authorization:"Bearer "+h.token,"Content-Type":"application/json"})}).then(function(n){200==n.status||201==n.status?!function(){var n=Object.assign({},c);delete n.isNew,p.forEach(function(n){return n.postMessage({action:i,entity:c,status:f.SUCCESS})}),e.transaction("rw",s,l,function(){s["delete"](c.id),s.put(n),l["delete"](c.id)});var t=setTimeout(function(){p.forEach(function(t){return t.postMessage({action:i,entity:n})}),clearTimeout(t)},5e3)}():!function(){var t=Object.assign({},c,{status:f.FAILURE,error:n.statusText});p.forEach(function(n){return n.postMessage({action:i,entity:t,status:f.FAILURE})}),s.put(t)}()})["catch"](function(n){p.forEach(function(n){return n.postMessage({action:i,entity:c,status:f.PENDING_IDLE})}),e.transaction("rw",s,l,function(){s["delete"](c.id).then(function(){return s.put(Object.assign({},c,{status:f.PENDING_IDLE}))})})})}}).call(t,function(){return this}())},function(n,t,e){(function(n,r){function i(n,t){this._id=n,this._clearFn=t}var o=e(7).nextTick,a=Function.prototype.apply,u=Array.prototype.slice,c={},s=0;t.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(n){n.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},t.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},t._unrefActive=t.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))},t.setImmediate="function"==typeof n?n:function(n){var e=s++,r=arguments.length<2?!1:u.call(arguments,1);return c[e]=!0,o(function(){c[e]&&(r?n.apply(null,r):n.call(null),t.clearImmediate(e))}),e},t.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(t,e(1).setImmediate,e(1).clearImmediate)},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}var i=e(4),o=r(i),a={appEnv:"dist",apiUrl:"http://sisdn.herokuapp.com/api",keycloak:{url:"https://keycloak-sisdn.rhcloud.com/auth",realm:"sisdn-realm",clientId:"sisdn",redirect_uri:"http://sisdn.herokuapp.com/login",flow:"standard"}};n.exports=Object.freeze(Object.assign({},o["default"],a))},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function o(n){var t=s["default"].db.version,e=new u["default"](n.username+"@sisdn-"+t),r={},o=!0,a=!1,c=void 0;try{for(var f,l=s["default"].admin.db[Symbol.iterator]();!(o=(f=l.next()).done);o=!0){var h=f.value;Object.assign(r,i({},h.name,h.schema),i({},h.name+"Orig",h.schema))}}catch(d){a=!0,c=d}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw c}}return e.version(t).stores(r),e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=e(6),u=r(a),c=e(2),s=r(c)},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={name:"faculties",schema:"id, title, titleTr, isActive, status, ts"},r={name:"departments",schema:"id, title, titleTr, isActive, status, ts"},i={name:"courses",schema:"id, title, titleTr, facultyId, departmentId, remarks, isActive, status, ts"},o={name:"programs",schema:"id, title, titleTr, facultyId, terms, creditHours, isActive, status, ts"};t["default"]={onlineCheckInterval:1e4,entityUpdateInterval:1e4,url:"http://localhost:8888",cors:"cors",db:{name:"sisdndb",version:"1"},admin:{db:[e,r,i,o],path:{get:"/admin"},faculties:{path:{post:"/admin/faculties",put:"/admin/faculties",get:"/admin/faculties"}},departments:{path:{post:"/admin/departments",put:"/admin/departments",get:"/admin/departments"}},courses:{path:{post:"/admin/courses",put:"/admin/courses",get:"/admin/courses"}},programs:{path:{post:"/admin/programs",put:"/admin/programs",get:"/admin/programs"}}}}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUCCESS="SUCCESS",t.FAILURE="FAILURE",t.PENDING_ACTIVE="PENDING_ACTIVE",t.PENDING_IDLE="PENDING_IDLE",t.EXISTING="EXISTING"},function(n,t,e){(function(t,e){!function(t,e){n.exports=e()}(this,function(){"use strict";function n(n,t){return"object"!=typeof t&&(t=t()),L(t).forEach(function(e){n[e]=t[e]}),n}function t(t){return{from:function(e){return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,{extend:function(r){n(t.prototype,"object"!=typeof r?r(e.prototype):r)}}}}}function r(n,t,e){return V.call(n,t,e)}function i(n,t){return t(n)}function o(n,t){this.name=n,this.message=t}function a(n,t,e,r){this.name="ModifyError",this.failures=t,this.failedKeys=r,this.successCount=e,this.message=t.join("\n")}function u(e,l){function p(){qn.on("versionchange",function(n){qn.close(),qn.on("error").fire(new Q.VersionChange)})}function b(n){this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function _(n,t,e,o){if(0===n){L(Tn).forEach(function(n){C(t,n,Tn[n].primKey,Tn[n].indexes)});var a=qn._createTransaction(Un,jn,Tn);a.idbtrans=t,a.idbtrans.onerror=A(e,["populating database"]),a.on("error").subscribe(e),an.newPSD(function(){an.PSD.trans=a;try{qn.on("populate").fire(a)}catch(n){o.onerror=t.onerror=function(n){n.preventDefault()};try{t.abort()}catch(r){}t.db.close(),e(n)}})}else{var u=[],c=Cn.filter(function(t){return t._cfg.version===n})[0];if(!c)throw new Q.Upgrade("Dexie specification of currently installed DB version is missing");Tn=qn._dbSchema=c._cfg.dbschema;var s=!1,f=Cn.filter(function(t){return t._cfg.version>n});f.forEach(function(n){var o=Tn,a=n._cfg.dbschema;Dn(o,t),Dn(a,t),Tn=qn._dbSchema=a;var c=O(o,a);c.add.forEach(function(n){u.push(function(t,e){C(t,n[0],n[1].primKey,n[1].indexes),e()})}),c.change.forEach(function(n){if(n.recreate)throw new Q.Upgrade("Not yet support for changing primary key");u.push(function(t,e){var r=t.objectStore(n.name);n.add.forEach(function(n){z(r,n)}),n.change.forEach(function(n){r.deleteIndex(n.name),z(r,n)}),n.del.forEach(function(n){r.deleteIndex(n)}),e()})}),n._cfg.contentUpgrade&&u.push(function(t,o){s=!0;var u=qn._createTransaction(Un,r(t.db.objectStoreNames),a);u.idbtrans=t;var c=0;u._promise=i(u._promise,function(n){return function(t,e,r){function i(n){return function(){n.apply(this,arguments),0===--c&&o()}}return++c,n.call(this,t,function(n,t,r){arguments[0]=i(n),arguments[1]=i(t),e.apply(this,arguments)},r)}}),t.onerror=A(e,["running upgrader function for version",n._cfg.version]),u.on("error").subscribe(e),n._cfg.contentUpgrade(u),0===c&&o()}),s&&xn()||u.push(function(n,t){W(a,n),t()})});var l=function(){try{u.length?u.shift()(t,l):V(Tn,t)}catch(n){o.onerror=t.onerror=function(n){n.preventDefault()};try{t.abort()}catch(r){}t.db.close(),e(n)}};l()}}function O(n,t){var e={del:[],add:[],change:[]};for(var r in n)t[r]||e.del.push(r);for(var r in t){var i=n[r],o=t[r];if(i){var a={name:r,def:t[r],recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)a.recreate=!0,e.change.push(a);else{var u=i.indexes.reduce(function(n,t){return n[t.name]=t,n},{}),c=o.indexes.reduce(function(n,t){return n[t.name]=t,n},{});for(var s in u)c[s]||a.del.push(s);for(var s in c){var f=u[s],l=c[s];f?f.src!==l.src&&a.change.push(l):a.add.push(l)}(a.recreate||a.del.length>0||a.add.length>0||a.change.length>0)&&e.change.push(a)}}else e.add.push([r,o])}return e}function C(n,t,e,r){var i=n.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach(function(n){z(i,n)}),i}function V(n,t){L(n).forEach(function(e){t.db.objectStoreNames.contains(e)||C(t,e,n[e].primKey,n[e].indexes)})}function W(n,t){for(var e=0;e<t.db.objectStoreNames.length;++e){var r=t.db.objectStoreNames[e];null!==n[r]&&void 0!==n[r]||t.db.deleteObjectStore(r)}}function z(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function J(n,t){throw new Q.InvalidTable("Table "+t[0]+" not part of transaction. Original Scope Function Source: "+u.Promise.PSD.trans.scopeFunc.toString())}function H(n,t,e,r){this.name=n,this.schema=e,this.hook=An[n]?An[n].hook:g(null,{creating:[h,c],reading:[f,s],updating:[d,c],deleting:[y,c]}),this._tpf=t,this._collClass=r||nn}function X(n,t,e,r){H.call(this,n,t,e,r||sn)}function Y(n,t,e,r){function i(n,t,e,r){return o._promise(n,e,r)}var o=this;this.db=qn,this.mode=n,this.storeNames=t,this.idbtrans=null,this.on=g(this,["complete","error"],"abort"),this._reculock=0,this._blockedFuncs=[],this._psd=null,this.active=!0,this._dbschema=e,r&&(this.parent=r),this._tpf=i,this.tables=Object.create(Nn);for(var a=t.length-1;-1!==a;--a){var u=t[a],c=qn._tableFactory(n,e[u],i);this.tables[u]=c,this[u]||(this[u]=c)}}function $(n,t,e){this._ctx={table:n,index:":id"===t?null:t,collClass:n._collClass,or:e}}function nn(n,t){var e=null,r=null;if(t)try{e=t()}catch(i){if(r=i,!(i instanceof o)&&i.name&&Z[i.name])try{throw new Z[i.name](i.message,i)}catch(a){r=a}}var u=n._ctx;this._ctx={table:u.table,index:u.index,isPrimKey:!u.index||u.table.schema.primKey.keyPath&&u.index===u.table.schema.primKey.name,range:e,op:"openCursor",dir:"next",unique:"",algorithm:null,filter:null,isMatch:null,offset:0,limit:1/0,error:r,or:u.or}}function sn(){nn.apply(this,arguments)}function fn(n,t){return n._cfg.version-t._cfg.version}function ln(n,t,e,r,i,o){e.forEach(function(e){var a=qn._tableFactory(r,i[e],t);n.forEach(function(n){n[e]||(o?Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var n=an.PSD&&an.PSD.trans;return n&&n.db===qn?n.tables[e]:a}}):n[e]=a)})})}function hn(n){n.forEach(function(n){for(var t in n)n[t]instanceof H&&delete n[t]})}function dn(n,t,e,r,i,o){var a=an.PSD;o=o||s,n.onerror||(n.onerror=A(i)),t?n.onsuccess=P(function(a){var u=n.result;if(u){var c=function(){u["continue"]()};t(u,function(n){c=n},r,i)&&e(o(u.value),u,function(n){c=n}),c()}else r()},i,a):n.onsuccess=P(function(t){var i=n.result;if(i){var a=function(){i["continue"]()};e(o(i.value),i,function(n){a=n}),a()}else r()},i,a)}function pn(n){var t=[];return n.split(",").forEach(function(n){n=n.trim();var e=n.replace("&","").replace("++","").replace("*",""),r=0!==e.indexOf("[")?e:n.substring(n.indexOf("[")+1,n.indexOf("]")).split("+");t.push(new B(e,r||null,-1!==n.indexOf("&"),-1!==n.indexOf("*"),-1!==n.indexOf("++"),G(r),-1!==r.indexOf(".")))}),t}function vn(n,t){return En.cmp(n,t)}function yn(n,t){return vn(n,t)<0?n:t}function mn(n,t){return vn(n,t)>0?n:t}function gn(n,t){return En.cmp(n,t)}function bn(n,t){return En.cmp(t,n)}function wn(n,t){return t>n?-1:n===t?0:1}function _n(n,t){return n>t?-1:n===t?0:1}function Pn(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}function xn(){return navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0}function Sn(){if(qn.verno=Kn.version/10,qn._dbSchema=Tn={},jn=r(Kn.objectStoreNames,0),0!==jn.length){var n=Kn.transaction(U(jn),"readonly");jn.forEach(function(t){for(var e=n.objectStore(t),r=e.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf("."),o=new B(r,r||"",!1,!1,!!e.autoIncrement,r&&"string"!=typeof r,i),a=[],u=0;u<e.indexNames.length;++u){var c=e.index(e.indexNames[u]);r=c.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf(".");var s=new B(c.name,r,!!c.unique,!!c.multiEntry,!1,r&&"string"!=typeof r,i);a.push(s)}Tn[t]=new R(t,o,a,{})}),ln([An],qn._transPromiseFactory,L(Tn),Un,Tn)}}function Dn(n,t){for(var e=t.db.objectStoreNames,i=0;i<e.length;++i)for(var o=e[i],a=t.objectStore(o),u=0;u<a.indexNames.length;++u){var c=a.indexNames[u],s=a.index(c).keyPath,f="string"==typeof s?s:"["+r(s).join("+")+"]";if(n[o]){var l=n[o].idxByName[f];l&&(l.name=c)}}}var kn=l&&l.addons||u.addons,On=u.dependencies,En=On.indexedDB,In=On.IDBKeyRange,Tn=this._dbSchema={},Cn=[],jn=[],An={},Nn={},Kn=null,Fn=!0,Mn=null,Bn=!1,Rn="readonly",Un="readwrite",qn=this,Ln=[],Gn=!0,Vn=l&&"autoOpen"in l?l.autoOpen:!0,Wn=!!q();this.version=function(n){if(Kn||Bn)throw new Q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=Cn.filter(function(t){return t._cfg.version===n})[0];return t?t:(t=new b(n),Cn.push(t),Cn.sort(fn),t)},n(b.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?n(this._cfg.storesSource,t):t;var e={};Cn.forEach(function(t){n(e,t._cfg.storesSource)});var r=this._cfg.dbschema={};return this._parseStoresSpec(e,r),Tn=qn._dbSchema=r,hn([An,qn,Nn]),ln([Nn],J,L(r),Un,r),ln([An,qn,this._cfg.tables],qn._transPromiseFactory,L(r),Un,r,!0),jn=L(r),this},upgrade:function(n){var t=this;return un(function(){n(qn._createTransaction(Un,L(t._cfg.dbschema),t._cfg.dbschema))}),this._cfg.contentUpgrade=n,this},_parseStoresSpec:function(n,t){L(n).forEach(function(e){if(null!==n[e]){var r={},i=pn(n[e]),o=i.shift();if(o.multi)throw new Q.Schema("Primary key cannot be multi-valued");o.keyPath&&k(r,o.keyPath,o.auto?0:o.keyPath),i.forEach(function(n){if(n.auto)throw new Q.Schema("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new Q.Schema("Index must have a name and cannot be an empty string");k(r,n.keyPath,n.compound?n.keyPath.map(function(){return""}):"")}),t[e]=new R(e,o,i,r)}})}}),this._allTables=An,this._tableFactory=function(n,t,e){return n===Rn?new H(t.name,e,t,nn):new X(t.name,e,t)},this._createTransaction=function(n,t,e,r){return new Y(n,t,e,r)},this._transPromiseFactory=function(n,t,e){if(!Fn||an.PSD&&an.PSD.letThrough){var r=qn._createTransaction(n,t,Tn);return r._promise(n,function(n,t){r.error(function(n){qn.on("error").fire(n)}),an.newPSD(function(){an.PSD.trans=r,e(function(t){r.complete(function(){n(t)})},t,r)})})}if(!Bn){if(!Vn)return S(new Q.DatabaseClosed);qn.open()}var i=new an(function(r,o){Ln.push({resume:function(){var a=qn._transPromiseFactory(n,t,e);i.onuncatched=a.onuncatched,a.then(r,o)}})});return i},this._whenReady=function(n){if(!cn&&Fn&&(!an.PSD||!an.PSD.letThrough)){if(!Bn){if(!Vn)return S(new Q.DatabaseClosed);qn.open()}return new an(function(t,e){Ln.push({resume:function(){n(t,e)}})})}return new an(n)},this.verno=0,this.open=function(){return Kn?an.resolve(qn):Bn?new an(function(n,t){return qn._whenReady(function(){n(qn)},function(n){t(n)})}):(Mn=null,Bn=!0,Fn=!0,new an(function(n,t){function r(n){try{i.transaction.abort()}catch(e){}if(Kn)try{Kn.close()}catch(e){}Kn=null,Bn=!1,Mn=n,Fn=!1,t(Mn),Ln.forEach(function(n){n.resume()}),Ln=[]}cn&&n(qn);var i,o=!1;try{if(Cn.length>0&&(Gn=!1),!En)throw new Q.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using Safari, make sure to include indexedDB polyfill.");if(i=Gn?En.open(e):En.open(e,Math.round(10*qn.verno)),!i)throw new Q.MissingAPI("IndexedDB API not available");i.onerror=A(r,["opening database",e]),i.onblocked=function(n){qn.on("blocked").fire(n)},i.onupgradeneeded=P(function(n){if(Gn&&!qn._allowEmptyDB){i.onerror=function(n){n.preventDefault()},i.transaction.abort(),i.result.close();var t=En.deleteDatabase(e);t.onsuccess=t.onerror=function(){r(new Q.NoSuchDatabase("Database "+e+" doesnt exist"))}}else{0===n.oldVersion&&(o=!0),i.transaction.onerror=A(r);var a=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;_(a/10,i.transaction,r,i)}},r),i.onsuccess=P(function(t){if(Bn=!1,Kn=i.result,Gn)Sn();else if(Kn.objectStoreNames.length>0)try{Dn(Tn,Kn.transaction(U(Kn.objectStoreNames),Rn))}catch(t){}Kn.onversionchange=qn.on("versionchange").fire,Wn||F(function(n){return-1===n.indexOf(e)?n.push(e):void 0}),an.newPSD(function(){function t(){Fn=!1,Ln.forEach(function(n){n.resume()}),Ln=[],n(qn)}an.PSD.letThrough=!0;try{var e=qn.on.ready.fire();e&&"function"==typeof e.then?e.then(t,function(n){Kn.close(),Kn=null,r(n)}):w(t)}catch(i){r(i)}})},r)}catch(a){r(a)}}))},this.close=function(){Kn?(Kn.close(),Kn=null,Vn=!1,Fn&&(Ln.forEach(function(n){n.resume()}),Ln=[]),Fn=!1,Mn=new Q.DatabaseClosed):Bn&&qn.on("ready",function(){return an.reject(new Q.DatabaseClosed)})},this["delete"]=function(){var n=arguments;return new an(function(t,r){function i(){qn.close();var n=En.deleteDatabase(e);n.onsuccess=function(){Wn||F(function(n){var t=n.indexOf(e);return t>=0?n.splice(t,1):void 0}),t()},n.onerror=A(r,["deleting",e]),n.onblocked=function(){qn.on("blocked").fire()}}if(n.length>0)throw new Q.InvalidArgument("Arguments not allowed in db.delete()");Bn?Ln.push({resume:i}):i()})},this.backendDB=function(){return Kn},this.isOpen=function(){return null!==Kn},this.hasFailed=function(){return null!==Mn},this.dynamicallyOpened=function(){return Gn},this.name=e,Object.defineProperty(this,"tables",{get:function(){return L(An).map(function(n){return An[n]})}}),this.on=g(this,"error","populate","blocked",{ready:[m,c],versionchange:[v,c]}),this.on.ready.subscribe=i(this.on.ready.subscribe,function(n){return function(t,e){function r(){return e||qn.on.ready.unsubscribe(r),t.apply(this,arguments)}n.call(this,r),qn.isOpen()&&(Fn?Ln.push({resume:r}):r())}}),un(function(){qn.on("populate").fire(qn._createTransaction(Un,jn,Tn)),qn.on("error").fire(new Error)}),this.transaction=function(n,t,e){function o(t,r){var o=null;try{if(s)throw s;o=qn._createTransaction(n,f,Tn,a);var u=f.map(function(n){return o.tables[n]});u.push(o);var c,l=0;an.newPSD(function(){an.PSD.trans=o,o.scopeFunc=e,a&&(o.idbtrans=a.idbtrans,o._promise=i(o._promise,function(n){return function(t,e,r){function i(n){return function(t){var e;return an._rootExec(function(){e=n(t),an._tickFinalize(function(){0===--l&&o.active&&(o.active=!1,o.on.complete.fire())})}),e}}return++l,n.call(this,t,function(n,t,r){return e(i(n),i(t),r)},r)}})),o.complete(function(){t(c)}),o.error(function(n){o.idbtrans&&(o.idbtrans.onerror=K);try{o.abort()}catch(t){}a&&(a.active=!1,a.on.error.fire(n));var e=r(n);a||e||qn.on.error.fire(n)}),an._rootExec(function(){c=e.apply(o,u),c&&"function"==typeof c.next&&"function"==typeof c["throw"]&&(c=M(c))})}),(!o.idbtrans||a&&0===l)&&o._nop()}catch(h){o&&o.idbtrans&&(o.idbtrans.onerror=K),o&&o.abort(),a&&a.on.error.fire(h),w(function(){r(h)||qn.on("error").fire(h)})}}t=r(arguments,1,arguments.length-1),e=arguments[arguments.length-1];var a=an.PSD&&an.PSD.trans;a&&a.db===qn&&-1===n.indexOf("!")||(a=null);var u=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");var c=G(t[0])?t.reduce(function(n,t){return n.concat(t)}):t,s=null,f=c.map(function(n){return"string"==typeof n?n:(n instanceof H||(s=s||new TypeError("Invalid type. Arguments following mode must be instances of Table or String")),n.name)});return"r"==n||n==Rn?n=Rn:"rw"==n||n==Un?n=Un:s=new Q.InvalidArgument("Invalid transaction mode: "+n),a&&(s||(a&&a.mode===Rn&&n===Un&&(u?a=null:s=s||new Q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY")),a&&f.forEach(function(n){a.tables.hasOwnProperty(n)||(u?a=null:s=s||new Q.SubTransaction("Table "+n+" not included in parent transaction. Parent Transaction function: "+a.scopeFunc.toString()))}))),a?a._promise(n,o,"lock"):qn._whenReady(o)},this.table=function(n){if(cn&&Gn)return new X(n);if(!An.hasOwnProperty(n))throw new Q.InvalidTable("Table "+n+" does not exist");return An[n]},n(H.prototype,function(){function n(){throw new Q.ReadOnly("Current Transaction is READONLY")}return{_trans:function(n,t,e){return this._tpf(n,[this.name],t,e)},_idbstore:function(n,t,e){if(cn)return new an(t);var r=this;return this._tpf(n,[this.name],function(n,e,i){t(n,e,i.idbtrans.objectStore(r.name),i)},e)},get:function(n,t){var e=this;return this._idbstore(Rn,function(t,r,i){cn&&t(e.schema.instanceTemplate);var o=i.get(n);o.onerror=A(r,["getting",n,"from",e.name]),o.onsuccess=function(){t(e.hook.reading.fire(o.result))}}).then(t)},where:function(n){return new $(this,n)},count:function(n){return this.toCollection().count(n)},offset:function(n){return this.toCollection().offset(n)},limit:function(n){return this.toCollection().limit(n)},reverse:function(){return this.toCollection().reverse()},filter:function(n){return this.toCollection().and(n)},each:function(n){var t=this;return cn&&n(t.schema.instanceTemplate),this._idbstore(Rn,function(e,r,i){var o=i.openCursor();o.onerror=A(r,["calling","Table.each()","on",t.name]),dn(o,null,n,e,r,t.hook.reading.fire)})},toArray:function(n){var t=this;return this._idbstore(Rn,function(n,e,r){cn&&n([t.schema.instanceTemplate]);var i=[],o=r.openCursor();o.onerror=A(e,["calling","Table.toArray()","on",t.name]),dn(o,null,function(n){i.push(n)},function(){n(i)},e,t.hook.reading.fire)}).then(n)},orderBy:function(n){return new this._collClass(new $(this,n))},toCollection:function(){return new this._collClass(new $(this))},mapToClass:function(n,t){this.schema.mappedClass=n;var e=Object.create(n.prototype);t&&j(e,t),this.schema.instanceTemplate=e;var r=function(t){if(!t)return t;var e=Object.create(n.prototype);for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),n},defineClass:function(n){return this.mapToClass(u.defineClass(n),n)},add:n,put:n,"delete":n,clear:n,update:n}}),t(X).from(H).extend(function(){function n(n,t,e,r){return function(i){i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),n.push(i.target.error),e&&e.onerror&&an.newPSD(function(){an.PSD.trans=r,e.onerror(i.target.error)}),t&&t(n)}}function t(n,t,e,r){return e?function(i){e.onsuccess&&an.newPSD(function(){an.PSD.trans=r,e.onsuccess(i.target.result)}),t&&t(n)}:function(){t(n)}}return{bulkAdd:function(e){var r=this.hook.creating.fire;return this._idbstore(Un,function(i,o,a,u){if(!a.keyPath)throw new Q.Unsupported("bulkAdd() only support inbound keys");if(0===e.length)return i([]);var s,f,l,h=[];if(r!==c){var d=a.keyPath,p={onerror:null,onsuccess:null};f=n(h,null,p,u),l=t(h,null,p,u);for(var v=0,y=e.length;y>v;++v){var m=e[v],g=D(m,d),b=r.call(p,g,m,u);void 0===g&&void 0!==b&&(m=I(m),k(m,d,b)),s=a.add(m),y-1>v&&(s.onerror=f,p.onsuccess&&(s.onsuccess=l),p.onerror=null,p.onsuccess=null)}s.onerror=n(h,i,p,u),s.onsuccess=t(h,i,p,u)}else{f=n(h);for(var v=0,y=e.length;y>v;++v)s=a.add(e[v]),s.onerror=f;s.onerror=n(h,i),s.onsuccess=t(h,i)}})},add:function(n,t){var e=this,r=this.hook.creating.fire;return this._idbstore(Un,function(i,o,a,u){var s={onsuccess:null,onerror:null};if(r!==c){var f=void 0!==t?t:a.keyPath?D(n,a.keyPath):void 0,l=r.call(s,f,n,u);void 0===f&&void 0!==l&&(a.keyPath?k(n,a.keyPath,l):t=l)}var h=void 0!==t?a.add(n,t):a.add(n);h.onerror=A(function(n){return s.onerror&&an.newPSD(function(){an.PSD.trans=u,s.onerror(n)}),o(n)},["adding",n,"into",e.name]),h.onsuccess=function(t){var e=a.keyPath;e&&k(n,e,t.target.result),s.onsuccess&&an.newPSD(function(){an.PSD.trans=u,s.onsuccess(t.target.result)}),i(h.result)}})},put:function(n,t){var e=this,r=this.hook.creating.fire,i=this.hook.updating.fire;return r!==c||i!==c?this._trans(Un,function(r,i,o){var a=void 0!==t?t:e.schema.primKey.keyPath&&D(n,e.schema.primKey.keyPath);void 0===a?o.tables[e.name].add(n).then(r,i):(o._lock(),n=I(n),o.tables[e.name].where(":id").equals(a).modify(function(t){this.value=n}).then(function(r){return 0===r?o.tables[e.name].add(n,t):a})["finally"](function(){o._unlock()}).then(r,i))}):this._idbstore(Un,function(r,i,o){var a=void 0!==t?o.put(n,t):o.put(n);a.onerror=A(i,["putting",n,"into",e.name]),a.onsuccess=function(t){var e=o.keyPath;e&&k(n,e,t.target.result),r(a.result)}})},"delete":function(n){return this.hook.deleting.subscribers.length?this.where(":id").equals(n)["delete"]():this._idbstore(Un,function(t,e,r){var i=r["delete"](n);i.onerror=A(e,["deleting",n,"from",r.name]),i.onsuccess=function(n){t(i.result)}})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection()["delete"]():this._idbstore(Un,function(n,t,e){var r=e.clear();r.onerror=A(t,["clearing",e.name]),r.onsuccess=function(t){n(r.result)}})},update:function(n,t){if("object"!=typeof t||G(t))throw new Q.InvalidArgument("db.update(keyOrObject, modifications). modifications must be an object.");if("object"!=typeof n||G(n))return this.where(":id").equals(n).modify(t);L(t).forEach(function(e){k(n,e,t[e])});var e=D(n,this.schema.primKey.keyPath);return void 0===e&&an.reject(new Q.InvalidArgument("Given object does not contain its primary key")),this.where(":id").equals(e).modify(t)}}}),n(Y.prototype,{_lock:function(){return++this._reculock,1===this._reculock&&an.PSD&&(an.PSD.lockOwnerFor=this),this},_unlock:function(){if(0===--this._reculock)for(an.PSD&&(an.PSD.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{n()}catch(t){}}return this},_locked:function(){return this._reculock&&(!an.PSD||an.PSD.lockOwnerFor!==this)},_nop:function(n){this.tables[this.storeNames[0]].get(0).then(n)},_promise:function(n,t,e){var r=this;return an.newPSD(function(){var i;return r._locked()?i=new an(function(i,o){r._blockedFuncs.push(function(){r._promise(n,t,e).then(i,o)})}):(i=r.active?new an(function(i,a){if(!r.idbtrans&&n){if(!Kn)throw Mn?Mn instanceof Q.DatabaseClosed?Mn:new Q.OpenFailed(Mn):new Q.DatabaseClosed;var c=r.idbtrans=Kn.transaction(U(r.storeNames),r.mode);c.onerror=function(n){r.on("error").fire(n&&n.target.error),n.preventDefault(),r.abort()},c.onabort=function(n){w(function(){r.on("error").fire(new Q.Abort("Transaction aborted for unknown reason"))}),r.active=!1,r.on("abort").fire(n)},c.oncomplete=function(n){r.active=!1,r.on("complete").fire(n)}}e&&r._lock();try{t(i,a,r)}catch(s){if(!(s instanceof o)&&s.name&&Z[s.name])try{throw new Z[s.name](s.message,s)}catch(f){s=f}u.ignoreTransaction(function(){r.on("error").fire(s)}),r.abort(),a(s)}}):an.reject(N(new Q.TransactionInactive("Transaction is inactive. Original Scope Function Source: "+r.scopeFunc.toString()))),r.active&&e&&i["finally"](function(){r._unlock()})),i.onuncatched=function(n){u.ignoreTransaction(function(){r.on("error").fire(n)}),r.abort()},i})},complete:function(n){return this.on("complete",n)},error:function(n){return this.on("error",n)},abort:function(){if(this.idbtrans&&this.active)try{this.active=!1,this.idbtrans.abort(),this.on.error.fire(new Q.Abort("Transaction Aborted"))}catch(n){}},table:function(n){if(!this.tables.hasOwnProperty(n))throw new Q.InvalidTable("Table "+n+" not in transaction");return this.tables[n]}}),n($.prototype,function(){function n(n,t,e){var r=n instanceof $?new n._ctx.collClass(n):n;try{throw e?new e(t):new TypeError(t)}catch(i){r._ctx.error=i}return r}function t(n){return new n._ctx.collClass(n,function(){return In.only("")}).limit(0)}function e(n){return r(1===n.length&&G(n[0])?n[0]:n)}function i(n){return"next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}function o(n){return"next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}function a(n,t,e,r,i,o){for(var a=Math.min(n.length,r.length),u=-1,c=0;a>c;++c){var s=t[c];if(s!==r[c])return i(n[c],e[c])<0?n.substr(0,c)+e[c]+e.substr(c+1):i(n[c],r[c])<0?n.substr(0,c)+r[c]+e.substr(c+1):u>=0?n.substr(0,u)+t[u]+e.substr(u+1):null;i(n[c],s)<0&&(u=c)}return a<r.length&&"next"===o?n+e.substr(n.length):a<n.length&&"prev"===o?n.substr(0,e.length):0>u?null:n.substr(0,u)+r[u]+e.substr(u+1)}function u(n,t,e,r){function u(n){c=i(n),s=o(n),f="next"===n?wn:_n;var t=e.map(function(n){return{lower:s(n),upper:c(n)}}).sort(function(n,t){return f(n.lower,t.lower)});l=t.map(function(n){return n.upper}),h=t.map(function(n){return n.lower}),d=n,p="next"===n?"":r}var c,s,f,l,h,d,p,v=e.length;u("next");var y=new n._ctx.collClass(n,function(){return In.bound(l[0],h[v-1]+r)});y._ondirectionchange=function(n){u(n)};var m=0;return y._addAlgorithm(function(n,e,r){var i=n.key;if("string"!=typeof i)return!1;var o=s(i);if(t(o,h,m))return!0;for(var u=null,c=m;v>c;++c){var y=a(i,o,l[c],h[c],f,d);null===y&&null===u?m=c+1:(null===u||f(u,y)>0)&&(u=y)}return e(null!==u?function(){n["continue"](u+p)}:r),!1}),y}return{between:function(e,r,i,o){i=i!==!1,o=o===!0;try{return vn(e,r)>0||0===vn(e,r)&&(i||o)&&(!i||!o)?t(this):new this._ctx.collClass(this,function(){return In.bound(e,r,!i,!o)})}catch(a){return n(this,rn)}},equals:function(n){return new this._ctx.collClass(this,function(){return In.only(n)})},above:function(n){return new this._ctx.collClass(this,function(){return In.lowerBound(n,!0)})},aboveOrEqual:function(n){return new this._ctx.collClass(this,function(){return In.lowerBound(n)})},below:function(n){return new this._ctx.collClass(this,function(){return In.upperBound(n,!0)})},belowOrEqual:function(n){return new this._ctx.collClass(this,function(){return In.upperBound(n)})},startsWith:function(t){return"string"!=typeof t?n(this,on):this.between(t,t+tn,!0,!0)},startsWithIgnoreCase:function(t){return"string"!=typeof t?n(this,on):""===t?this.startsWith(t):u(this,function(n,t){return 0===n.indexOf(t[0])},[t],tn)},equalsIgnoreCase:function(t){return"string"!=typeof t?n(this,on):u(this,function(n,t){return n===t[0]},[t],"")},anyOfIgnoreCase:function(r){var i=e(arguments);return 0===i.length?t(this):i.every(function(n){return"string"==typeof n})?u(this,function(n,t){return-1!==t.indexOf(n)},i,""):n(this,"anyOfIgnoreCase() only works with strings")},startsWithAnyOfIgnoreCase:function(r){var i=e(arguments);return 0===i.length?t(this):i.every(function(n){return"string"==typeof n})?u(this,function(n,t){return t.some(function(t){return 0===n.indexOf(t)})},i,tn):n(this,"startsWithAnyOfIgnoreCase() only works with strings")},anyOf:function(r){var i=e(arguments),o=gn;try{i.sort(o)}catch(a){return n(this,rn)}if(0===i.length)return t(this);var u=new this._ctx.collClass(this,function(){
return In.bound(i[0],i[i.length-1])});u._ondirectionchange=function(n){o="next"===n?gn:bn,i.sort(o)};var c=0;return u._addAlgorithm(function(n,t,e){for(var r=n.key;o(r,i[c])>0;)if(++c,c===i.length)return t(e),!1;return 0===o(r,i[c])?!0:(t(function(){n["continue"](i[c])}),!1)}),u},notEqual:function(n){return this.inAnyRange([[-(1/0),n],[n,en]],{includeLowers:!1,includeUppers:!1})},noneOf:function(t){var r=e(arguments);if(0===r.length)return new this._ctx.collClass(this);try{r.sort(gn)}catch(i){return n(this,rn)}var o=r.reduce(function(n,t){return n?n.concat([[n[n.length-1][1],t]]):[[-(1/0),t]]},null);return o.push([r[r.length-1],en]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(e,r){function i(n,t){for(var e=0,r=n.length;r>e;++e){var i=n[e];if(vn(t[0],i[1])<0&&vn(t[1],i[0])>0){i[0]=yn(i[0],t[0]),i[1]=mn(i[1],t[1]);break}}return e===r&&n.push(t),n}function o(n,t){return l(n[0],t[0])}function a(n){return!p(n)&&!v(n)}var u=this._ctx;if(0===e.length)return t(this);if(!e.every(function(n){return void 0!==n[0]&&void 0!==n[1]&&gn(n[0],n[1])<=0}))return n(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Q.InvalidArgument);var c,s=!r||r.includeLowers!==!1,f=r&&r.includeUppers===!0,l=gn;try{c=e.reduce(i,[]),c.sort(o)}catch(h){return n(this,rn)}var d=0,p=f?function(n){return gn(n,c[d][1])>0}:function(n){return gn(n,c[d][1])>=0},v=s?function(n){return bn(n,c[d][0])>0}:function(n){return bn(n,c[d][0])>=0},y=p,m=new u.collClass(this,function(){return In.bound(c[0][0],c[c.length-1][1],!s,!f)});return m._ondirectionchange=function(n){"next"===n?(y=p,l=gn):(y=v,l=bn),c.sort(o)},m._addAlgorithm(function(n,t,e){for(var r=n.key;y(r);)if(++d,d===c.length)return t(e),!1;return a(r)?!0:0===vn(r,c[d][1])||0===vn(r,c[d][0])?!1:(t(function(){l===gn?n["continue"](c[d][0]):n["continue"](c[d][1])}),!1)}),m},startsWithAnyOf:function(r){var i=e(arguments);return i.every(function(n){return"string"==typeof n})?0===i.length?t(this):this.inAnyRange(i.map(function(n){return[n,n+tn]})):n(this,"startsWithAnyOf() only works with strings")}}}),n(nn.prototype,function(){function n(n,t){n.filter=Pn(n.filter,t)}function t(n,t){n.isMatch=Pn(n.isMatch,t)}function e(n,t){if(n.isPrimKey)return t;var e=n.table.schema.idxByName[n.index];if(!e)throw new Q.Schema("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return n.isPrimKey?t:t.index(e.name)}function r(n,t){return e(n,t)[n.op](n.range||null,n.dir+n.unique)}function i(n,t,e,i,o){n.or?!function(){function a(){2===++f&&e()}function u(n,e,r){if(!c||c(e,r,a,i)){var o=e.primaryKey.toString();s.hasOwnProperty(o)||(s[o]=!0,t(n,e,r))}}var c=n.filter,s={},f=0;n.or._iterate(u,a,i,o),dn(r(n,o),n.algorithm,u,a,i,n.table.hook.reading.fire)}():dn(r(n,o),Pn(n.algorithm,n.filter),t,e,i,n.table.hook.reading.fire)}function o(n){return n.table.schema.instanceTemplate}return{_read:function(n,t){var e=this._ctx;return e.error?e.table._trans(null,function(n,t){t(e.error)}):e.table._idbstore(Rn,n).then(t)},_write:function(n){var t=this._ctx;return t.error?t.table._trans(null,function(n,e){e(t.error)}):t.table._idbstore(Un,n,"locked")},_addAlgorithm:function(n){var t=this._ctx;t.algorithm=Pn(t.algorithm,n)},_iterate:function(n,t,e,r){return i(this._ctx,n,t,e,r)},each:function(n){var t=this._ctx;return cn&&n(o(t)),this._read(function(e,r,o){i(t,n,e,r,o)})},count:function(n){if(cn)return an.resolve(0).then(n);var t=this,r=this._ctx;if(r.filter||r.algorithm||r.or){var o=0;return this._read(function(n,t,e){i(r,function(){return++o,!1},function(){n(o)},t,e)},n)}return this._read(function(n,i,o){var a=e(r,o),u=r.range?a.count(r.range):a.count();u.onerror=A(i,["calling","count()","on",t.name]),u.onsuccess=function(t){n(Math.min(t.target.result,Math.max(0,r.limit-r.offset)))}},n)},sortBy:function(n,t){function e(n,t){return t?e(n[i[t]],t-1):n[o]}function r(n,t){var r=e(n,a),i=e(t,a);return i>r?-u:r>i?u:0}var i=n.split(".").reverse(),o=i[0],a=i.length-1,u="next"===this._ctx.dir?1:-1;return this.toArray(function(n){return n.sort(r)}).then(t)},toArray:function(n){var t=this._ctx;return this._read(function(n,e,r){cn&&n([o(t)]);var a=[];i(t,function(n){a.push(n)},function(){n(a)},e,r)},n)},offset:function(t){var e=this._ctx;return 0>=t?this:(e.offset+=t,e.or||e.algorithm||e.filter?n(e,function(n,e,r){return--t<0}):n(e,function(n,e,r){return 0===t?!0:1===t?(--t,!1):(e(function(){n.advance(t),t=0}),!1)}),this)},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),n(this._ctx,function(n,e,r){return--t<=0&&e(r),t>=0}),this},until:function(t,e){var r=this._ctx;return cn&&t(o(r)),n(this._ctx,function(n,r,i){return t(n.value)?(r(i),e):!0}),this},first:function(n){return this.limit(1).toArray(function(n){return n[0]}).then(n)},last:function(n){return this.reverse().first(n)},and:function(e){return cn&&e(o(this._ctx)),n(this._ctx,function(n){return e(n.value)}),t(this._ctx,e),this},or:function(n){return new $(this._ctx.table,n,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(n){var t=this._ctx;return cn&&n(D(o(this._ctx),this._ctx.index?this._ctx.table.schema.idxByName[this._ctx.index].keyPath:this._ctx.table.schema.primKey.keyPath)),t.isPrimKey||(t.op="openKeyCursor"),this.each(function(t,e){n(e.key,e)})},eachUniqueKey:function(n){return this._ctx.unique="unique",this.eachKey(n)},keys:function(n){var t=this._ctx;t.isPrimKey||(t.op="openKeyCursor");var e=[];return cn?new an(this.eachKey.bind(this)).then(function(n){return[n]}).then(n):this.each(function(n,t){e.push(t.key)}).then(function(){return e}).then(n)},uniqueKeys:function(n){return this._ctx.unique="unique",this.keys(n)},firstKey:function(n){return this.limit(1).keys(function(n){return n[0]}).then(n)},lastKey:function(n){return this.reverse().firstKey(n)},distinct:function(){var t={};return n(this._ctx,function(n){var e=n.primaryKey.toString(),r=t.hasOwnProperty(e);return t[e]=!0,!r}),this}}}),t(sn).from(nn).extend({modify:function(t){var e=this,r=this._ctx,i=r.table.hook,o=i.updating.fire,u=i.deleting.fire;return cn&&"function"==typeof t&&t.call({value:r.table.schema.instanceTemplate},r.table.schema.instanceTemplate),this._write(function(i,s,f,l){function h(n,t,e){function i(n){return P.push(n),S.push(o.primKey),o.onerror&&an.newPSD(function(){an.PSD.trans=l,o.onerror(n)}),p(),!0}O=t.primaryKey;var o={primKey:t.primaryKey,value:n,onsuccess:null,onerror:null};if(v.call(o,n)!==!1){var a=!o.hasOwnProperty("value");++b,x(function(){var e=a?t["delete"]():t.update(o.value);e.onerror=A(i,a?["deleting",n,"from",r.table.name]:["modifying",n,"on",r.table.name]),e.onsuccess=function(n){o.onsuccess&&an.newPSD(function(){an.PSD.trans=l,o.onsuccess(o.value)}),++w,p()}},i)}else o.onsuccess&&o.onsuccess(o.value)}function d(n){return n&&(P.push(n),S.push(O)),s(new a("Error modifying one or more objects",P,w,S))}function p(){_&&w+P.length===b&&(P.length>0?d():i(w))}var v;if("function"==typeof t)v=o===c&&u===c?t:function(n){var e=I(n);if(t.call(this,n)===!1)return!1;if(this.hasOwnProperty("value")){var r=T(e,this.value),i=o.call(this,r,this.primKey,e,l);i&&(n=this.value,L(i).forEach(function(t){k(n,t,i[t])}))}else u.call(this,this.primKey,n,l)};else if(o===c){var y=L(t),m=y.length;v=function(n){for(var e=!1,r=0;m>r;++r){var i=y[r],o=t[i];D(n,i)!==o&&(k(n,i,o),e=!0)}return e}}else{var g=t;t=E(g),v=function(e){var r=!1,i=o.call(this,t,this.primKey,I(e),l);return i&&n(t,i),L(t).forEach(function(n){var i=t[n];D(e,n)!==i&&(k(e,n,i),r=!0)}),i&&(t=E(g)),r}}var b=0,w=0,_=!1,P=[],S=[],O=null;e._iterate(h,function(){_=!0,p()},d,f)})},"delete":function(){return this.modify(function(){delete this.value})}}),n(this,{Collection:nn,Table:H,Transaction:Y,Version:b,WhereClause:$,WriteableCollection:sn,WriteableTable:X}),p(),kn.forEach(function(n){n(qn)})}function c(){}function s(n){return n}function f(n,t){return n===s?t:function(e){return t(n(e))}}function l(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function h(n,t){return n===c?t:function(){var e=n.apply(this,arguments);void 0!==e&&(arguments[0]=e);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?l(r,this.onsuccess):r),i&&(this.onerror=this.onerror?l(i,this.onerror):i),void 0!==o?o:e}}function d(t,e){return t===c?e:function(){var r=t.apply(this,arguments);void 0!==r&&n(arguments[0],r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?l(i,this.onsuccess):i),o&&(this.onerror=this.onerror?l(o,this.onerror):o),void 0===r?void 0===a?void 0:a:void 0===a?r:n(r,a)}}function p(n,t){return n===c?t:function(){return n.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function v(n,t){return n===c?t:function(){return t.apply(this,arguments)===!1?!1:n.apply(this,arguments)}}function y(n,t){return n===c?t:function(){n.apply(this,arguments),t.apply(this,arguments)}}function m(n,t){return n===c?t:function(){var e=n.apply(this,arguments);if(e&&"function"==typeof e.then){var r=this,i=arguments;return e.then(function(){return t.apply(r,i)})}return t.apply(this,arguments)}}function g(n,t){function e(n,t,e){if(G(n))return o(n);if("object"==typeof n)return i(n);t||(t=p),e||(e=c);var r={subscribers:[],fire:e,subscribe:function(n){r.subscribers.push(n),r.fire=t(r.fire,n)},unsubscribe:function(n){r.subscribers=r.subscribers.filter(function(t){return t!==n}),r.fire=r.subscribers.reduce(t,e)}};return u[n]=s[n]=r,r}function i(n){L(n).forEach(function(t){var r=n[t];if(G(r))e(t,n[t][0],n[t][1]);else{if("asap"!==r)throw new Q.InvalidArgument("Invalid event config");var i=e(t,null,function(){var n=arguments;i.subscribers.forEach(function(t){w(function(){t.apply(nn,n)})})});i.subscribe=function(n){-1===i.subscribers.indexOf(n)&&i.subscribers.push(n)},i.unsubscribe=function(n){var t=i.subscribers.indexOf(n);-1!==t&&i.subscribers.splice(t,1)}}})}function o(n){function t(){return r?!1:void(r=!0)}var r=!1;n.forEach(function(n){e(n).subscribe(t)})}var a=arguments,u={},s=function(t,e){if(e){var i=r(arguments,1),o=u[t];return o.subscribe.apply(o,i),n}return"string"==typeof t?u[t]:void 0};s.addEventType=e;for(var f=1,l=a.length;l>f;++f)e(a[f]);return s}function b(n){if(!n)throw new Q.Internal("Assertion failed")}function w(n){nn.setImmediate?e(n):setTimeout(n,0)}function _(n){var t=setTimeout(n,1e3);clearTimeout(t)}function P(n,t,e){return function(){var r=an.PSD;an.PSD=e;try{n.apply(this,arguments)}catch(i){t(i)}finally{an.PSD=r}}}function x(n,t){try{n()}catch(e){t(e)}}function S(n){try{throw n}catch(t){return an.reject(n)}}function D(n,t){if(n.hasOwnProperty(t))return n[t];if(!t)return n;if("string"!=typeof t){for(var e=[],r=0,i=t.length;i>r;++r){var o=D(n,t[r]);e.push(o)}return e}var a=t.indexOf(".");if(-1!==a){var u=n[t.substr(0,a)];return void 0===u?void 0:D(u,t.substr(a+1))}}function k(n,t,e){if(n&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(n)))if("string"!=typeof t&&"length"in t){b("string"!=typeof e&&"length"in e);for(var r=0,i=t.length;i>r;++r)k(n,t[r],e[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===e?delete n[a]:n[a]=e;else{var c=n[a];c||(c=n[a]={}),k(c,u,e)}}else void 0===e?delete n[t]:n[t]=e}}function O(n,t){"string"==typeof t?k(n,t,void 0):"length"in t&&[].map.call(t,function(t){k(n,t,void 0)})}function E(n){var t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function I(n){if(!n||"object"!=typeof n)return n;var t;if(G(n)){t=[];for(var e=0,r=n.length;r>e;++e)t.push(I(n[e]))}else if(n instanceof Date)t=new Date,t.setTime(n.getTime());else{t=n.constructor?Object.create(n.constructor.prototype):{};for(var i in n)n.hasOwnProperty(i)&&(t[i]=I(n[i]))}return t}function T(n,t){var e={};for(var r in n)n.hasOwnProperty(r)&&(t.hasOwnProperty(r)?n[r]!==t[r]&&JSON.stringify(n[r])!=JSON.stringify(t[r])&&(e[r]=t[r]):e[r]=void 0);for(var r in t)t.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(e[r]=t[r]);return e}function C(n){if("function"==typeof n)return new n;if(G(n))return[C(n[0])];if(n&&"object"==typeof n){var t={};return j(t,n),t}return n}function j(n,t){return L(t).forEach(function(e){var r=C(t[e]);n[e]=r}),n}function A(n,t){return function(e){var r=e&&e.target.error||new Error("");if(t){var i=" occurred when "+t.map(function(n){switch(typeof n){case"function":return n();case"string":return n;default:return JSON.stringify(n)}}).join(" ");r.message&&r.message!=r.name&&(i+=". "+r.message);var o=r.stack;r.name?Z[r.name]&&(r=new Z[r.name](r.name+i,r),o&&(r.stack=o)):r+=i}return n(r),e&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()),!1}}function N(n){try{throw n}catch(t){return t}}function K(n){n.preventDefault()}function F(n){var t,e=u.dependencies.localStorage;if(!e)return n([]);try{t=JSON.parse(e.getItem("Dexie.DatabaseNames")||"[]")}catch(r){t=[]}n(t)&&e.setItem("Dexie.DatabaseNames",JSON.stringify(t))}function M(n){function t(n){return function(t){var r=n(t),i=r.value;return r.done?i:i&&"function"==typeof i.then?i.then(o,a):Array.isArray(i)?e(i,0):o(i)}}function e(n,t){if(t===n.length)return o(n);var r=n[t];return r.constructor&&"function"==typeof r.constructor.all?r.constructor.all(n).then(o,a):e(n,t+1)}var r=function(t){return n.next(t)},i=function(t){return n["throw"](t)},o=t(r),a=t(i);return t(r)()}function B(n,t,e,r,i,o,a){this.name=n,this.keyPath=t,this.unique=e,this.multi=r,this.auto=i,this.compound=o,this.dotted=a;var u="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(e?"&":"")+(r?"*":"")+(i?"++":"")+u}function R(n,t,e,r){this.name=n,this.primKey=t||new B,this.indexes=e||[new B],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=e.reduce(function(n,t){return n[t.name]=t,n},{})}function U(n){return 1===n.length?n[0]:n}function q(){var n=u.dependencies.indexedDB,t=n&&(n.getDatabaseNames||n.webkitGetDatabaseNames);return t&&t.bind(n)}var L=Object.keys,G=Array.isArray,V=[].slice,W=["Modify","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed"],z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=W.concat(z),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed"};t(o).from(Error),t(a).from(o);var X=J.reduce(function(n,t){return n[t+"Error"]=t+"Error",n},{}),Y=o,Q=J.reduce(function(n,e){function r(n,t){this.name=e+"Error","string"==typeof n?(this.message=n,this.inner=null):"object"==typeof n?(this.message=n.message,this.inner=t):(this.message=H[e],this.inner=null)}return t(r).from(Y),n[e]=r,n},{});Q.Syntax=SyntaxError,Q.Type=TypeError,Q.Range=RangeError;var Z=z.reduce(function(n,t){return n[t+"Error"]=Q[t],n},{}),$=J.reduce(function(n,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(n[t+"Error"]=Q[t]),n},{});if($.ModifyError=a,$.DexieError=o,"undefined"==typeof nn)var nn=self||window;var tn=String.fromCharCode(65535),en=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(n){return tn}}(),rn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",on="String expected.",an=function(){function n(n,t){y.push([n,r(arguments,1)])}function t(){var n=y;y=[];for(var t=0,e=n.length;e>t;++t){var r=n[t];r[0].apply(nn,r[1])}}function e(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],this._catched=!1;var t=this,r=!0;this._PSD=e.PSD;try{h(this,n,function(n){r?p(u,t,n):u(t,n)},function(n){return r?(p(s,t,n),!1):s(t,n)})}finally{r=!1}}function i(r,i){if(null===r._state)return void r._deferreds.push(i);var o=r._state?i.onFulfilled:i.onRejected;if(null===o)return(r._state?i.resolve:i.reject)(r._value);var u,c=v;v=!1,p=n;try{var s=e.PSD;e.PSD=r._PSD,u=o(r._value),r._state||u&&"function"==typeof u.then&&u._state===!1||a(r),i.resolve(u)}catch(f){var l=i.reject(f);if(!l&&r.onuncatched)try{r.onuncatched(f)}catch(f){}}finally{if(e.PSD=s,c){do{for(;y.length>0;)t();var h=m.pop();if(h)try{h()}catch(f){}}while(m.length>0||y.length>0);p=d,v=!0}}}function o(e){var r=v;v=!1,p=n;try{e()}finally{if(r){do{for(;y.length>0;)t();var i=m.pop();if(i)try{i()}catch(o){}}while(m.length>0||y.length>0);p=d,v=!0}}}function a(n){n._catched=!0,n._parent&&a(n._parent)}function u(n,t){var r=e.PSD;e.PSD=n._PSD;try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then)return void h(n,function(n,e){t.then(n,e)},function(t){u(n,t)},function(t){s(n,t)});n._state=!0,n._value=t,f.call(n)}catch(i){s(i)}finally{e.PSD=r}}function s(n,t){var r=e.PSD;if(e.PSD=n._PSD,n._state=!1,n._value=t,f.call(n),!n._catched)try{n.onuncatched&&n.onuncatched(n._value),e.on.error.fire(n._value)}catch(i){}return e.PSD=r,n._catched}function f(){for(var n=0,t=this._deferreds.length;t>n;n++)i(this,this._deferreds[n]);this._deferreds=[]}function l(n,t,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r}function h(n,t,e,r){var i=!1;try{t(function(n){i||(i=!0,e(n))},function(t){return i?n._catched:(i=!0,r(t))})}catch(o){if(i)return;return r(o)}}var d=nn.setImmediate||function(n){var t=r(arguments,1);setTimeout(function(){n.apply(nn,t)},0)};_(function(){d=p=n=function(n){var t=arguments;setTimeout(function(){n.apply(nn,r(t,1))},0)}});var p=d,v=!0,y=[],m=[];return e.on=g(null,"error"),e.all=function(){var n=r(1===arguments.length&&G(arguments[0])?arguments[0]:arguments);return new e(function(t,e){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(n){r(o,n)},e)}n[o]=a,0===--i&&t(n)}catch(c){e(c)}}if(0===n.length)return t([]);for(var i=n.length,o=0;o<n.length;o++)r(o,n[o])})},e.prototype.then=function(n,t){var r=this,o=new e(function(e,o){null===r._state?i(r,new l(n,t,e,o)):p(i,r,new l(n,t,e,o))});return o._PSD=this._PSD,o.onuncatched=this.onuncatched,o._parent=this,o},e.prototype._then=function(n,t){i(this,new l(n,t,c,c))},e.prototype["catch"]=function(n){if(1===arguments.length)return this.then(null,n);var t=arguments[0],r=arguments[1];return"function"==typeof t?this.then(null,function(n){return n instanceof t?r(n):e.reject(n)}):this.then(null,function(n){return n&&n.name===t?r(n):e.reject(n)})},e.prototype["finally"]=function(n){return this.then(function(t){return n(),t},function(t){return n(),e.reject(t)})},e.prototype.onuncatched=null,e.resolve=function(n){if(n&&"function"==typeof n.then)return n;var t=new e(function(){});return t._state=!0,t._value=n,t},e.reject=function(n){var t=new e(function(){});return t._state=!1,t._value=n,t},e.race=function(n){return new e(function(t,e){n.map(function(n){n.then(t,e)})})},e.PSD=null,e.newPSD=function(n){var t=e.PSD;e.PSD=t?Object.create(t):{};try{return n()}finally{e.PSD=t}},e._rootExec=o,e._tickFinalize=function(n){if(v)throw new Error("Not in a virtual tick");m.push(n)},e}(),un=function(){},cn=!1;u["delete"]=function(n){var t=new u(n),e=t["delete"]();return e.onblocked=function(n){return t.on("blocked",n),this},e},u.exists=function(n){return new u(n).open().then(function(n){return n.close(),!0})["catch"](u.NoSuchDatabaseError,function(){return!1})},u.getDatabaseNames=function(n){return new an(function(n,t){var e=q();if(e){var i=e();i.onsuccess=function(t){n(r(t.target.result,0))},i.onerror=A(t)}else F(function(t){return n(t),!1})}).then(n)},u.defineClass=function(t){function e(e){e?n(this,e):cn&&j(this,t)}return e},u.applyStructure=j,u.ignoreTransaction=function(n){return an.newPSD(function(){return an.PSD.trans=null,n()})},u.vip=function(n){return an.newPSD(function(){return an.PSD.letThrough=!0,n()})},u.async=function(n){return function(){try{var t=M(n.apply(this,arguments));return t&&"function"==typeof t.then?t:u.Promise.resolve(t)}catch(e){return u.Promise.reject(e)}}},u.spawn=function(n,t,e){try{var r=M(n.apply(e,t||[]));return r&&"function"==typeof r.then?r:u.Promise.resolve(r)}catch(i){return u.Promise.reject(i)}},Object.defineProperty(u,"currentTransaction",{get:function(){return an.PSD&&an.PSD.trans||null}}),u.Promise=an,u.derive=t,u.extend=n,u.override=i,u.events=g,u.getByKeyPath=D,u.setByKeyPath=k,u.delByKeyPath=O,u.shallowClone=E,u.deepClone=I,u.addons=[],u.fakeAutoComplete=un,u.asap=w,u.maxKey=en,n(u,$),u.MultiModifyError=u.ModifyError,u.errnames=X,u.IndexSpec=B,u.TableSchema=R;var sn=nn.idbModules&&nn.idbModules.shimIndexedDB?nn.idbModules:{};return u.dependencies={indexedDB:sn.shimIndexedDB||nn.indexedDB||nn.mozIndexedDB||nn.webkitIndexedDB||nn.msIndexedDB,IDBKeyRange:sn.IDBKeyRange||nn.IDBKeyRange||nn.webkitIDBKeyRange,Error:nn.Error||String,SyntaxError:nn.SyntaxError||String,TypeError:nn.TypeError||String,localStorage:null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:nn.localStorage},u.semVer="1.3.3",u.version=u.semVer.split(".").map(function(n){return parseInt(n)}).reduce(function(n,t,e){return n+t/Math.pow(10,2*e)}),_(function(){u.fakeAutoComplete=un=_,u.fake=cn=!0}),u["default"]=u,u})}).call(t,function(){return this}(),e(1).setImmediate)},function(n,t){function e(){s=!1,a.length?c=a.concat(c):f=-1,c.length&&r()}function r(){if(!s){var n=setTimeout(e);s=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,s=!1,clearTimeout(n)}}function i(n,t){this.fun=n,this.array=t}function o(){}var a,u=n.exports={},c=[],s=!1,f=-1;u.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];c.push(new i(n,t)),1!==c.length||s||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(n){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}}]);
//# sourceMappingURL=d35df0fb5aded5bc56c7.sharedworker.js.map